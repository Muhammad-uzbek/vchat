<html>
    <head>
        <title>Videochat</title>
        <link rel='stylesheet' href='./css/style.css'>
        <link rel='stylesheet' href='./css/filters.css'>
        <meta content="width = device-width, initial-scale=1", name="viewport"/>
        
        <meta name="google-signin-client_id" content="207494825303-o08ietin9gl4e1rpguln5pqaasukg8ab.apps.googleusercontent.com">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    </head>
    <body>
        <div class='main_container'>
        <div class='dashboard_container'>
            <div class='logo_container'>
                <img src='./utils/images/logovch.png'></img>
            </div>
            <div>
                <div class='description_container'>
                    <p class='description_container_paragraph'>
                        Videochatni boshlashingiz mumkin!
                    </p>
                </div>
                <div class='personal_code_container'>
                    <div class="personal_code_title_container">
                        <p class="personal_code_connecting_paragraph strangers_amount">
                            <i class="fa-regular fa-user"></i>
                            <span id="strangers_amount_paragraph">0</span>
                        </p>
                    </div>
                    
                    <div class='personal_code_title_container'>
                        <p class='personal_code_title_paragraph'>
                           Kodingiz:
                        </p>
                    </div>
                    <div class="personal_code_value_container">
                        <p class='personal_code_value_paragraph' id='personal_code_paragraph'>DDDDDD</p>
                        <button class='personal_code_copy_button' id='personal_code_copy_button'>
                            <i class="fa-solid fa-copy"></i>
                        </button>
                    </div>
                </div>
                </div>
                <div class='personal_code_connecting_container'>
                    <p class='personal_code_connecting_paragraph'>Personal Code</p>
                    <!-- <div class='personal_code_connecting_input_container'>
                        <input class='personal_code_input' id='personal_code_input'></input>
                    </div> -->
                    <div class='personal_code_connecting_buttons_container'>
                        <button class='connecting_button' id='personal_code_chat_button'>
                            <img src='./utils/images/chatButton.png' class='connecting_buttons_image'></img>
                        </button>
                        <button class='connecting_button display_none' id='personal_code_video_button'>
                            <img src='./utils/images/videoButton.png' class='connecting_buttons_image'></img>
                        </button>
                    </div>
                </div>
                <!-- <div class='stranger_connecting_container'>
                    <div class='stranger_buttons_container'>
                        <button class='connecting_button display_none' id='stranger_video_button'>
                            <img src='/utils/images/videoButton.png' class='connecting_buttons_image'></img>
                            <i class="fa-solid fa-video"></i>
                            Videochatni boshlash
                        </button>
                    </div>
                </div> -->
                <div class="filters-menu-container stranger_connecting_container">
                    <p class="stranger_title_container">Filterlar</p>
                    <div class="filters-box">
                        <div class="filter-el" id="nofilter" data-filter="nofilter">
                            <img src="./utils/images/filters/nofilter.png" alt="">
                            <p>Filtersiz</p>
                        </div>
                        <div class="filter-el" id="f1977" data-filter="f1977">
                            <img src="./utils/images/filters/1977.png" alt="">
                            <p>1977</p>
                        </div>
                        <div class="filter-el" id="brannan" data-filter="brannan">
                            <img src="./utils/images/filters/brannan.png" alt="">
                            <p>Brannan</p>
                        </div>
                        <div class="filter-el" id="inkwell" data-filter="inkwell">
                            <img src="./utils/images/filters/inkwell.png" alt="">
                            <p>Inkwell</p>
                        </div>
                        <div class="filter-el" id="lofi" data-filter="lofi">
                            <img src="./utils/images/filters/lofi.png" alt="">
                            <p>Lofi</p>
                        </div>
                        <div class="filter-el"  id="toaster" data-filter="toaster">
                            <img src="./utils/images/filters/toaster.png" alt="">
                            <p>Toaster</p>
                        </div>
                        <div class="filter-el"  id="valencia" data-filter="valencia">
                            <img src="./utils/images/filters/valencia.png" alt="">
                            <p>Valencia</p>
                        </div>
                    </div>
                </div>
                <div class='checkbox_container visibility_hidden'>
                    <div class='checkbox_connection' id='allow_strangers_checkbox'>
                        <img id='allow_strangers_checkbox_image' src='./utils/images/check.png'></img>
                    </div>
                    <p class='checkbox_container_paragraph'>
                        Ruxsat berish
                    </p>
                </div>
                <div class='dashboard_blur display_none' id='dashboard_blur'></div>
            </div>
        <div class='call_container'>
            <div class='videos_container'>
                <div id='video_placeholder' class='videos_placeholder'>
                        <div class='stranger_buttons_container'>
                            <button class='connecting_button display_none' id='stranger_video_button'>
                                <!-- <img src='/utils/images/videoButton.png' class='connecting_buttons_image'></img> -->
                                <i class="fa-solid fa-video"></i>
                                Videochatni boshlash
                            </button>
                        </div>
                </div>
                <video class='remote_video display_none' autoplay id='remote_video'></video>
                <div class='local_video_container'>
                    <video class='local_video' id='local_video'  autoplay></video>
                </div>
                <div class='call_buttons_container display_none' id='call_buttons'>
                    <button class='call_button_small' id='hang_up_button'>
                        <img src='./utils/images/hangUp.png'></img>
                    </button>
                    <button class='call_button_small' id='mic_button'>
                        <img src='./utils/images/mic.png' id='mic_button_image'></img>
                    </button>
                    <button class='call_button_large' id='next_button'>
                        <i class="fa-solid fa-forward"></i>
                    </button>
                    <button class='call_button_small' id='camera_button'>
                        <img src='./utils/images/camera.png' id='camera_button_image'></img>
                    </button>
                   
                    <!-- <button class='call_button_small' id='screen_sharing_button'>
                        <img src='./utils/images/switchCameraScreenSharing.png'></img>
                    </button> -->
                    <button class='call_button_small' id='start_recording_button'>
                        <img src='./utils/images/recordingStart.png'></img>
                    </button>
                </div>
                <div class='finish_chat_button_container display_none' id='finish_chat_button_container'>
                    <button class='call_button_large' id='finish_chat_call_button'>
                        <img src='./utils/images/hangUp.png'></img>
                    </button>
                </div>
                <div class='video_recording_buttons_container display_none' id='video_recording_buttons'>
                    <button id='pause_recording_button'>
                        <img src='./utils/images/pause.png'></img>
                    </button>
                    <button id='resume_recording_button' class='display_none'>
                        <img src='./utils/images/resume.png'></img>
                    </button>
                    <button id='stop_recording_button'>
                         To'xtatish 
                    </button>
                </div>
            </div>
        </div>
        <div class='messenger_container'>
            <div class="messenger_inner_container">
                <div class='messages_container' id='messages_container'></div>
                <div class='new_message_container display_none' id='new_message'>
                    <input class='new_message_input' id='new_message_input' type='text' placeholder="Yozish..."></input>
                    <button class='send_message_button' id='send_message_button'>
                        <img class='send_message_button_image' src='./utils/images/sendMessageButton.png'></image>
                    </button>
                </div>
            </div>
                
        </div>
        <div id='dialog'></div>    
        <div class="register" id="register">
            <div class="register-dialog" id="register_dialog">
                <!-- <div class="g-signin2" data-onsuccess="onSignIn"></div> -->
            
            <!-- <div class="fb-login-button" data-width="" data-size="large" data-button-type="continue_with" data-layout="rounded" data-auto-logout-link="true" data-use-continue-as="true"></div> -->

            <!-- <fb:login-button
                scope="public_profile,email"
                onlogin="checkLoginState();">
            </fb:login-button> -->
                <h2>
                    <i class="fa-solid fa-phone"></i>
                    Telefon raqamni kiriting
                </h2>
                <div class="number-input">
                    <input type="number" id="phonenumber" placeholder="" autofocus class="register-input" value="998" pattern="\d*" onkeypress="if(this.value.length>=12) return false;">
                    <div class="send-btn" id="sendbtn">
                        <button id="send_code" class="register-btn"><i class="fa-solid fa-chevron-right"></i></button>
                    </div>
                </div>
                <div class="smscode-input" id="smscode_input">
                    <input type="number" id="smscode" placeholder="SMS kod" class="register-input smscode-input-noner" pattern="\d*" onkeypress="if(this.value.length>=4) return false;">
                </div>
            </div> 
        </div>
        </div>
        <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v16.0" nonce="VqkLGc2N"></script>
        <script src="https://apis.google.com/js/platform.js" async defer></script>
        <!-- <script>
            function onSignIn(googleUser) {
                var profile = googleUser.getBasicProfile();
                console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
                console.log('Name: ' + profile.getName());
                console.log('Image URL: ' + profile.getImageUrl());
                console.log('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not present.
            }
        </script> -->
        
        <script>
            function statusChangeCallback(response) {  // Called with the results from FB.getLoginStatus().
                console.log('statusChangeCallback');
                console.log(response);                   // The current login status of the person.
                if (response.status === 'connected') {   // Logged into your webpage and Facebook.
                testAPI();  
                } else {                                 // Not logged into your webpage or we are unable to tell.
                document.getElementById('status').innerHTML = 'Please log ' +
                    'into this webpage.';
                }
            }
            function checkLoginState() {
            FB.getLoginStatus(function(response) {
                statusChangeCallback(response);
            });
            }
            window.fbAsyncInit = function() {
            FB.init({
                appId      : '1292758364641763',
                cookie     : true,
                xfbml      : true,
                version    : 'v16.0',
                redirectUri: 'https://localhost:3000'
            });
                
            FB.AppEvents.logPageView();   
                
            };
        
            (function(d, s, id){
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) {return;}
            js = d.createElement(s); js.id = id;
            js.src = "https://connect.facebook.net/en_US/sdk.js";
            fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));
        </script>
        <script src="./js/reg.js"></script>
        <script src='/socket.io/socket.io.js'></script>
        <script src='./js/elements.js' type='module'></script>
        <script src='./js/constants.js' type='module'></script>
        <script src='./js/ui.js' type='module'></script>
        <script src='./js/wss.js' type='module'></script>
        <script src='./js/store.js' type='module'></script>
        <script src='./js/webRTCHandler.js' type='module'></script>
        <script src='./js/recordingUtils.js' type='module'></script>
        <script src='./js/strangerUtils.js' type='module'></script>
        <script src='./js/main.js' type='module'></script>
    </body>
</html>